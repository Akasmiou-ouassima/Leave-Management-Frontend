<div class="popup" *ngIf="isModalOpen">
  <div class="popup-content">
    <div class="mt-4 ms-3">
      <h2>Add User</h2>
      <div class="close-button-container modal-header">
        <button class="btn btn-close" (click)="closePopup()"></button>
      </div>
    </div>
    <hr>
    <div *ngIf="errorMessage" class="text-capitalize text-bg-danger text-center">
      {{ errorMessage }}
    </div>
    <form class="mt-3" (ngSubmit)="handleSaveNewUser()" *ngIf="newUserFormGroup"
          [formGroup]="newUserFormGroup">
      <div class="row mt-3 ms-2">
        <div class="col-md-6 form-group">
          <label for="prenom" class="label-input">First Name*</label>
          <input type="text" id="prenom" name="prenom" class="custom-input form-control"
                 placeholder="Enter first name"  formControlName="prenom"
                 [ngClass]="{'border-danger': newUserFormGroup.controls['prenom'].invalid && newUserFormGroup.controls['prenom'].touched}">
          <div
            *ngIf="newUserFormGroup.controls['prenom']?.touched
                  && newUserFormGroup.controls['prenom']?.errors
                   && newUserFormGroup.controls['prenom']?.errors!['required']"
            class="text-danger"
          >
            First Name is required
          </div>
        </div>
        <div class="col-md-6 form-group">
          <label for="nom" class="label-input">Last Name*</label>
          <input type="text" id="nom" name="nom" class="custom-input form-control"
                 placeholder="Enter last name"  formControlName="nom"
                 [ngClass]="{'border-danger': newUserFormGroup.controls['nom'].invalid && newUserFormGroup.controls['nom'].touched}">
          <div
            *ngIf="newUserFormGroup.controls['nom']?.touched
                  && newUserFormGroup.controls['nom']?.errors
                   && newUserFormGroup.controls['nom']?.errors!['required']"
            class="text-danger"
          >
            Last Name is required
          </div>
        </div>
      </div>
      <div class="row mt-3 ms-2">
        <div class="col-md-6 form-group">
          <label for="poste" class="label-input">Job*</label>
          <input type="text" id="poste" name="poste" class="custom-input form-control" placeholder="Enter a job"
                 formControlName="poste"
                 [ngClass]="{'border-danger': newUserFormGroup.controls['poste'].invalid && newUserFormGroup.controls['poste'].touched}">
          <div
            *ngIf="newUserFormGroup.controls['poste']?.touched
                  && newUserFormGroup.controls['poste']?.errors
                   && newUserFormGroup.controls['poste']?.errors!['required']"
            class="text-danger"
          >
            Job is required
          </div>
        </div>
        <div class="col-md-6 form-group">
          <label for="tel" class="label-input">Phone Number*</label>
          <input type="text" id="tel" name="tel" class="custom-input form-control" placeholder="Enter phone number"
                 formControlName="tel"
                 [ngClass]="{'border-danger': newUserFormGroup.controls['tel'].invalid && newUserFormGroup.controls['tel'].touched}">
          <div
            *ngIf="newUserFormGroup.controls['tel']?.touched
                  && newUserFormGroup.controls['tel']?.errors
                   && newUserFormGroup.controls['tel']?.errors!['required']"
            class="text-danger"
          >
            Phone is required
          </div>
        </div>
      </div>

      <div class="row mt-3 ms-2">
        <div class="col-md-12 form-group">
          <label for="email" class="label-input">Email*</label>
          <input type="email" id="email" name="email" class="custom-input1 form-control" placeholder="www.example.com"
                 formControlName="email"
                 [ngClass]="{'border-danger': newUserFormGroup.controls['email'].invalid && newUserFormGroup.controls['email'].touched}">
          <div
            *ngIf="newUserFormGroup.controls['email']?.touched
                  && newUserFormGroup.controls['email']?.errors
                   && newUserFormGroup.controls['email']?.errors!['required']"
            class="text-danger"
          >
            Email is required
          </div>
          <div *ngIf="newUserFormGroup.controls['email']?.errors!['pattern']" class="text-danger">The email address must contain at least the @ character</div>
        </div>
      </div>
      <div class="row mt-3">
        <label for="address" class="label-input ms-4">Address*</label>
        <textarea style="height: 60px" id="address" class="custom-input1 custom-input-address form-control"
                  formControlName="adresse" name="adresse" placeholder="Enter address"
                  [ngClass]="{'border-danger': newUserFormGroup.controls['adresse'].invalid && newUserFormGroup.controls['adresse'].touched}">
         </textarea>
        <div
          *ngIf="newUserFormGroup.controls['adresse']?.touched
                  && newUserFormGroup.controls['adresse']?.errors
                   && newUserFormGroup.controls['adresse']?.errors!['required']"
          class="text-danger ms-4"
        >
          Address is required
        </div>
      </div>

      <div class="row mt-3 ms-2">
        <div class="col-md-6 form-group">
          <label class="label-input ms-1">Profile image</label>
          <div class='file file--upload mt-2'>
            <label for='input-file'>
              <i class="material-icons">cloud_upload</i>Upload
            </label>
            <input type="file" id="input-file" name="image" class="custom-input form-control" formControlName="image" (change)="onFileSelected($event)"/>
            <div *ngIf="newUserFormGroup.controls['image']?.touched && newUserFormGroup.controls['image']?.errors && newUserFormGroup.controls['image']?.errors!['required']" class="text-danger ms-4">
              Image is required
            </div>
          </div>
          <div *ngIf="selectedFileName" class="ms-3">{{ selectedFileName }}</div>
        </div>
        <div class="col-md-6 form-group">
          <label for="equipe" class="label-input">Select Employee's team*</label>
          <select id="equipe" class="custom-input " formControlName="equipeId"
                  [ngClass]="{'border-danger': newUserFormGroup.controls['equipeId'].invalid && newUserFormGroup.controls['eauipeId'].touched}">
            <option disabled selected>Select a team...</option>
            <option *ngFor="let equipe of equipesList" [value]="equipe.id" >{{ equipe.nom }}</option>
          </select>
          <div
            *ngIf="newUserFormGroup.controls['equipeId']?.touched
                  && newUserFormGroup.controls['equipeId']?.errors
                   && newUserFormGroup.controls['equipeId']?.errors!['required']"
            class="text-danger"
          >
            Team is required
          </div>
        </div>
      </div>
      <div class="row ms-3" style="margin-top: 35px;">
        <div class="col-md-6 form-group">
          <button type="reset" class="btn btn-cancel" (click)="closePopup()">Cancel</button>
        </div>
        <div class="col-md-6 form-group">
          <button type="submit" class="btn btn-confirm"  [disabled]="!newUserFormGroup.valid">Confirm</button>
        </div>
      </div>
    </form>
  </div>
</div>
